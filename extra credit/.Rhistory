x = "Activity",
y= "Total Incidents")+
theme_void()+
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
ggplot(activity_count, aes(x = reorder(activity, -total_incidents), y = total_incidents))+
geom_bar(stat = "identity", fill = "#F67280", alpha = 0.8)+
labs(title = "Top 5 Riskiest Activities Associated with Shark Incidents",
x = "Activity",
y= "Total Incidents")+
theme_void()+
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
ggplot(activity_count, aes(x = reorder(activity, -total_incidents), y = total_incidents, fill = activity))+
geom_bar(stat = "identity", fill = "#F67280", alpha = 0.8)+
labs(title = "Top 5 Riskiest Activities Associated with Shark Incidents",
x = "Activity",
y= "Total Incidents")+
theme_void()+
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
ggplot(activity_count, aes(x = reorder(activity, -total_incidents), y = total_incidents))+
geom_bar(stat = "identity", fill = "#F67280", alpha = 0.8)+
labs(title = "Top 5 Riskiest Activities Associated with Shark Incidents",
x = "Activity",
y= "Total Incidents")+
theme_void()+
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
fatalities <- global_sharks %>%
filter(fatal_y_n == "Y" & !is.na(sex) & sex != "")
View(fatalities)
fatalities_count <- fatalities %>%
group_by(sex) %>%
summarise(total_fatalities = n()) %>%
arrange(desc(total_fatalities))
ggplot(fatalities_count, aes(x = sex, y = total_fatalities, fill = sex))+
geom_bar(stat = "identity")+
labs(title = "Shark Fatalities by Sex",
x = "Sex",
y= "Fatalities")+
theme_gray()
fatalities <- global_sharks %>%
filter(fatal_y_n == "Y" & !is.na(sex))
fatalities_count <- fatalities %>%
group_by(sex) %>%
summarise(total_fatalities = n()) %>%
arrange(desc(total_fatalities))
ggplot(fatalities_count, aes(x = sex, y = total_fatalities, fill = sex))+
geom_bar(stat = "identity")+
labs(title = "Shark Fatalities by Sex",
x = "Sex",
y= "Fatalities")+
theme_gray()
fatalities <- global_sharks %>%
filter(fatal_y_n == "Y")
fatalities_count <- fatalities %>%
group_by(sex) %>%
summarise(total_fatalities = n()) %>%
arrange(desc(total_fatalities))
fatalities <- global_sharks %>%
filter(fatal_y_n == "Y")
fatalities_count <- fatalities %>%
group_by(sex) %>%
summarise(total_fatalities = n()) %>%
arrange(desc(total_fatalities))
ggplot(fatalities_count, aes(x = sex, y = total_fatalities, fill = sex))+
geom_bar(stat = "identity")+
labs(title = "Shark Fatalities by Sex",
x = "Sex",
y= "Fatalities")+
theme_gray()
View(fatalities_count)
fatalities <- global_sharks %>%
filter(fatal_y_n == "Y" & !is.na(sex) & !sex %in% c(".", "N"))
fatalities_count <- fatalities %>%
group_by(sex) %>%
summarise(total_fatalities = n()) %>%
arrange(desc(total_fatalities))
ggplot(fatalities_count, aes(x = sex, y = total_fatalities, fill = sex))+
geom_bar(stat = "identity")+
labs(title = "Shark Fatalities by Sex",
x = "Sex",
y= "Fatalities")+
theme_gray()
filt_shark <- global_sharks %>%
filter(sex %in% c("M", "F") & !is.na(age))
View(filt_shark)
fil_shark$age <- as.numeric(gsub("[^0-9.]", "", filt_shark$age))
filt_shark$age <- as.numeric(gsub("[^0-9.]", "", filt_shark$age))
ggplot(filt_shark, aes(x = sex, y = age, fill = sex))+
geom_boxplot()+
labs(title = "Age Range of Attacked Individuals by Sex",
x = "Sex",
y = "Age")+
theme_bw()
filt_shark <- global_sharks %>%
filter(sex %in% c("M", "F") & !is.na(age) & grep1("^[0-9]+$", age))
ggplot(activity_count, aes(x = reorder(activity, -total_incidents), y = total_incidents))+
geom_bar(stat = "identity", fill = "#F67280", alpha = 0.8)+
labs(title = "Top 5 Riskiest Activities Associated with Shark Incidents",
x = "Activity",
y= "Total Incidents")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
filt_shark <- global_sharks %>%
filter(sex %in% c("M", "F") & !is.na(age) & str_detect(agem "^\\d+$")))
filt_shark <- global_sharks %>%
filter(sex %in% c("M", "F") & !is.na(age) & str_detect(agem "^\\d+$"))
filt_shark <- global_sharks %>%
filter(sex %in% c("M", "F") & !is.na(age) & str_detect(age, "^\\d+$"))
filt_shark$age <- as.numeric(filt_shark$age)
ggplot(filt_shark, aes(x = sex, y = age, fill = sex))+
geom_boxplot()+
labs(title = "Age Range of Attacked Individuals by Sex",
x = "Sex",
y = "Age")+
theme_bw()
us_sharks <- global_sharks %>%
filter(country == "USA" & year >= 1950)
state_count <- us_sharks %>%
group_by(area) %>%
summarise(total_incidents = n()) %>%
arrange(desc(total_incidents)) %>%
head(5)
View(state_count)
ggplot(state_count, aes(x = state, y = total_incidents))+
geom_bar(fill = "#A7DCA5")+
labs(title = "Top 5 States in the USA of Recorded Shark Incidents Since 1950",
x = "State",
y = "Total Incidents")+
theme_linedraw()
ggplot(state_count, aes(x = area, y = total_incidents))+
geom_bar(fill = "#A7DCA5")+
labs(title = "Top 5 States in the USA of Recorded Shark Incidents Since 1950",
x = "State",
y = "Total Incidents")+
theme_linedraw()
ggplot(state_count, aes(x = area, y = total_incidents))+
geom_bar()+
labs(title = "Top 5 States in the USA of Recorded Shark Incidents Since 1950",
x = "State",
y = "Total Incidents")+
theme_linedraw()
ggplot(state_count, aes(x = area, y = total_incidents))+
geom_col(fill = "#2E8B57")+
labs(title = "Top 5 States in the USA of Recorded Shark Incidents Since 1950",
x = "State",
y = "Total Incidents")+
theme_linedraw()
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "Great White"))
warnings()
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "White"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "white"))
View(great_white_attacks)
View(global_sharks)
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "great|white"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "white" | str_detect(species, "great")))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white" | str_detect(species, "(?i)great")))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white") | str_detect(species, "(?i)great")))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white") | str_detect(species, "(?i)great"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white") | str_detect(species, "(?i)great")) %>%
filter(!str_detect((species, "(?i) ocean")))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white") | str_detect(species, "(?i)great")) %>%
filter(!str_detect((species, "(?i) ocean")))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white") | str_detect(species, "(?i)great")) %>%
filter(!str_detect(species, "(?i) ocean")))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white") | str_detect(species, "(?i)great")) %>%
filter(!str_detect(species, "(?i) ocean"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white") | str_detect(species, "(?i)great")) %>%
filter(!str_detect(species, "(?i) ocean") | !str_detect("Oceanic"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white") | str_detect(species, "(?i)great")) %>%
filter(!str_detect(species, "(?i) ocean") | !str_detect("(?i)Oceanic"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white") | str_detect(species, "(?i)great")) %>%
filter(!str_detect(species, "(?i) ocean") | !str_detect("(?i)Oceanic")))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white") | str_detect(species, "(?i)great")) %>%
filter(!str_detect(species, "(?i) ocean") | !str_detect(species, "(?i)Oceanic"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white") | str_detect(species, "(?i)great")) %>%
filter(!str_detect(species, "(?i) ocean") | !str_detect(species, "(?i)tip"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white(?!.*tip)") | str_detect(species, "(?i)great(?1.*tip)")) %>%
filter(!str_detect(species, "(?i) Oceanic"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white(?!.*tip)") | str_detect(species, "(?i)great(?1.*tip)")) %>%
filter(!str_detect(species, "(?i) oceanic"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white(?!.*tip)") | str_detect(species, "(?i)great(?1.*tip)"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white(?!.*\\btip\\b)") | str_detect(species, "(?i)great(?!.*\\btip\\b)"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white(?!.*\\btip\\b)") | str_detect(species, "(?i)great(?!.*\\btip\\b)")) %>%
filter(!str_detect(species, "(?i)oceanic\\s+whitetip"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white(?!.*\\btip\\b)") | str_detect(species, "(?i)great(?!.*\\btip\\b)")) %>%
filter(!str_detect(species, "(?i)whitetip\\s+reef\\s+shark|oceanic\\s+whitetip\\s+shark|tiger\\s+shark|\\bor\\b"))
warnings()
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white(?!.*\\btip\\b)") | str_detect(species, "(?i)great(?!.*\\btip\\b)")) %>%
filter(!str_detect(species, "(?i)oceanic\\s+whitetip"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white(?!.*\\btip\\b)") | str_detect(species, "(?i)great(?!.*\\btip\\b)")) %>%
filter(!str_detect(species, "(?i)oceanic\\s+whitetip") | !str_detect(species, "(?i)tiger|or|\\/|whitetip"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white(?!.*\\btip\\b)") | str_detect(species, "(?i)great(?!.*\\btip\\b)")) %>%
filter(!str_detect(species, "(?i)oceaniic\\s+whitetip") | !str_detect(species, "(?i)tiger|or|\\/|whitetip"))
great_white_attacks <- global_sharks %>%
filter(str_detect(species, "(?i)white(?!.*\\btip\\b)") | str_detect(species, "(?i)great(?!.*\\btip\\b)")) %>%
filter(!str_detect(species, "(?i)oceanic\\s+whitetip") | !str_detect(species, "(?i)tiger|or|\\/|whitetip"))
country_counts <-great_white_attacks %>%
group_by(country) %>%
summarise(total_incidents= n()) %>%
arrange(desc(total_incidents))
View(country_counts)
country_counts <-great_white_attacks %>%
group_by(country) %>%
summarise(total_incidents= n()) %>%
arrange(desc(total_incidents)) %>%
head(5)
fatal_great_white <- great_white_attacks %>%
group_by(country, fatal_y_n) %>%
summarise(total_attacks = n()) %>%
pivot_wider(names_from = fatal_y_n, values_from = total_attacks, names_prefix = "fatal_") %>%
mutate_if(is.numeric, replace_na, 0)
country_counts2 <- fatal_great_white %>%
mutate(total_attacks = fatal_Y + fatal_N)
country_counts2 <- fatal_great_white %>%
mutate(total_attacks = fatal_Y + fatal_N) %>%
head(5)
View(country_count)
View(country_counts)
View(country_counts2)
ggplot(country_counts2, aes(x = country, y = total_attacks, fill = fatal_y_n)) +
geom_bar(stat = "identity", position = "stack") +
facet_wrap(~ country) +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Attacks",
fill = "Fatal (Y/N)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts2, aes(x = country, y = total_incidents, fill = fatal_y_n)) +
geom_bar() +
facet_wrap(~ country) +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Attacks",
fill = "Fatal (Y/N)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts2, aes(x = country, y = total_attacks, fill = fatal_y_n)) +
geom_bar() +
facet_wrap(~ country) +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Attacks",
fill = "Fatal (Y/N)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts2, aes(x = country, y = total_attacks)) +
geom_bar() +
facet_wrap(~ country) +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Attacks",
fill = "Fatal (Y/N)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts2, aes(x = country, y = total_attacks)) +
geom_bar(stat = "identity") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Attacks") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_wrap(~ fatal_y_n, scales = "free_y")
ggplot(fatal_great_white, aes(x = country, y = fatal_Y + fatal_N, fill = factor(fatal_Y))) +
geom_bar(stat = "identity") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Attacks",
fill = "Fatal (Y/N)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_wrap(~ country, scales = "free_y")
country_counts <- great_white_attacks %>%
group_by(country, fatal_y_n) %>%
summarise(total_incidents= n()) %>%
arrange(desc(total_incidents)) %>%
head(5)
country_counts <- great_white_attacks %>%
group_by(country, fatal_y_n) %>%
summarise(total_incidents= n()) %>%
arrange(desc(total_incidents)) %>%
head(5)
View(country_counts)
great_white_attacks %>%
group_by(country) %>%
summarise(total_incidents = n())
great_white_attacks %>%
group_by(country) %>%
summarise(total_incidents = n()) %>%
arrange(desc(total_incidents))
great_white_attacks %>%
group_by(country) %>%
summarise(total_incidents = n()) %>%
arrange(desc(total_incidents)) %>%
head(5)
great_white_attacks %>%
group_by(country, fatal_y_n) %>%
summarise(total_incidents = n()) %>%
arrange(desc(total_incidents)) %>%
head(5)
ggplot(country_counts, aes(x = country, y = total_incidents, fill = fatal_y_n)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country, scales = "free") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts, aes(x = country, y = total_incidents, fill = fatal_y_n)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts, aes(x = country, y = total_incidents, fill = fatal_y_n)) +
geom_bar(position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts, aes(x = country, y = total_incidents, fill = fatal_y_n)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
great_white_attacks %>%
group_by(country, fatal_y_n) %>%
summarise(total_incidents = n()) %>%
arrange(desc(total_incidents))
great_white_attacks %>%
group_by(country) %>%
summarise(total_incidents = n()) %>%
arrange(desc(total_incidents))
country_counts_wide <- great_white_attacks %>%
pivot_wider(names_from = fatal_y_n, values_from = total_incidents)
country_counts_wide <- filtered_top_5_attacks %>%
pivot_wider(names_from = fatal_y_n, values_from = total_incidents)
filtered_top_5_attacks <- great_white_attacks %>%
group_by(country, fatal_y_n) %>%
summarise(total_incidents = n()) %>%
arrange(desc(total_incidents)) %>%
head(5)
country_counts_wide <- filtered_top_5_attacks %>%
pivot_wider(names_from = fatal_y_n, values_from = total_incidents)
View(country_counts_wide)
filtered_top_5_attacks <- great_white_attacks %>%
group_by(country, fatal_y_n) %>%
summarise(total_incidents = n()) %>%
arrange(desc(total_incidents))
country_counts_wide <- filtered_top_5_attacks %>%
pivot_wider(names_from = fatal_y_n, values_from = total_incidents)
ggplot(country_counts_wide, aes(x = country, y = total_incidents, fill = fatal_y_n)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
country_counts_wide <- filtered_top_5_attacks %>%
pivot_wider(names_from = fatal_y_n, values_from = total_incidents) %>%
select(-UNKNOWN)
country_counts_wide <- filtered_top_5_attacks %>%
pivot_wider(names_from = fatal_y_n, values_from = total_incidents) %>%
select(-UNKNOWN) %>%
head(5)
ggplot(country_counts_wide, aes(x = country, y = n, fill = factor(y))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts_wide, aes(x = country, y = N, fill = factor(Y))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts_wide, aes(x = country, y = N, fill = factor(Y))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Great White Shark Attacks for Top 5 Countries",
x = "Country",
y = "Total Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts_wide, aes(x = country) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Great White Shark Attacks for Top 5 Countries",
x = "Country",
y = "Total Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts_wide, aes(x = country, y = N, fill = factor(Y))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Great White Shark Attacks for Top 5 Countries",
x = "Country",
y = "Total Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts_wide, aes(x = country, y = n, fill = factor(y, levels = c("N", "Y")))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts_wide, aes(x = country, y = n, fill = factor(Y, levels = c("N", "Y")))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts_wide, aes(x = country, y = n, fill = factor(Y, levels = c("N", "Y")))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Total Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts_wide, aes(x = country, y = value, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Number of Incidents",
fill = "Fatal (Y/N)") +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts_wide, aes(x = country, y = N, fill = "Non-fatal")) +
geom_bar(stat = "identity", position = "dodge") +
geom_bar(aes(x = country, y = Y, fill = "Fatal"), stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Attacks for Top 5 Countries with Great White Shark Attacks",
x = "Country",
y = "Number of Incidents",
fill = "Fatal (Y/N)") +
scale_fill_manual(values = c("Non-fatal" = "blue", "Fatal" = "red")) +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts_wide, aes(x = country, y = N, fill = "Non-fatal")) +
geom_bar(stat = "identity", position = "dodge") +
geom_bar(aes(x = country, y = Y, fill = "Fatal"), stat = "identity", position = "dodge") +
labs(title = "Comparison of Fatal and Non-fatal Great White Shark Attacks for Top 5 Countries",
x = "Country",
y = "Number of Incidents",
fill = "Fatal (Y/N)") +
scale_fill_manual(values = c("Non-fatal" = "blue", "Fatal" = "red")) +
facet_wrap(~ country) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
global_sharks %>%
filter(!is.na(location), location != "Unknown") %>%
group_by(location) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
head(10)
